<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="icon" href="https://files.catbox.moe/w6l8pf.jpg">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DFS TECH - JOGO DA VELHA</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #000;
      color: #B00000;
      overflow: hidden;
    }

    #loadingScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg, #000 0%, #003344 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      color: #B00000;
      font-size: 24px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.6; }
      100% { opacity: 1; }
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      gap: 5px;
      margin: 80px auto 40px;
      justify-content: center;
    }

    .cell {
      width: 100px;
      height: 100px;
      font-size: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #B00000;
      background-color: #111;
      cursor: pointer;
      color: #B00000;
      transition: background 0.3s;
    }

    .cell:hover {
      background-color: #005066;
    }

    .button {
      background-color: #B00000;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .button:hover {
      background-color: #C40000;
    }

    .score {
      text-align: center;
      font-size: 20px;
      margin-top: 10px;
    }
  </style>
<link rel="stylesheet" href="/assets/css/dfs-standard.css">
</head>
<body>
<canvas id="dfs-bg-canvas" aria-hidden="true"></canvas>

<div id="loadingScreen">Carregando... <span id="loadingPercent">0%</span></div>

<div class="score">
  Vit√≥rias do Jogador: <span id="playerScore">0</span> |
  Dinheiro do Jogador: <span id="playerMoney">0</span>
</div>

<div class="grid" id="grid">
  <div class="cell" data-index="0"></div>
  <div class="cell" data-index="1"></div>
  <div class="cell" data-index="2"></div>
  <div class="cell" data-index="3"></div>
  <div class="cell" data-index="4"></div>
  <div class="cell" data-index="5"></div>
  <div class="cell" data-index="6"></div>
  <div class="cell" data-index="7"></div>
  <div class="cell" data-index="8"></div>
</div>

<div style="text-align: center;">
  <button class="button" onclick="reiniciarJogo()">Reiniciar</button>
</div>

<script>
  let loading = 0;
  const loadingSpan = document.getElementById('loadingPercent');
  const loadingScreen = document.getElementById('loadingScreen');
  const loadingInterval = setInterval(() => {
    loading++;
    loadingSpan.innerText = `${loading}%`;
    if (loading >= 100) {
      clearInterval(loadingInterval);
      loadingScreen.style.display = 'none';
    }
  }, 50);

  const cells = document.querySelectorAll('.cell');
  let board = Array(9).fill('');
  let currentPlayer = 'X';
  let isGameActive = true;
  let playerScore = 0;
  let playerMoney = 0;

  const winningConditions = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  function exibirResultado(mensagem) {
    const novaAba = window.open('', '_blank');
    novaAba.document.write(`
      <html>
      <head>
        <title>Resultado</title>
        <style>
          body {
            background: #000;
            color: #B00000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-family: 'Segoe UI', sans-serif;
            font-size: 24px;
            text-align: center;
          }
          button {
            margin-top: 20px;
            background-color: #B00000;
            color: #fff;
            border: none;
            padding: 10px 25px;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
          }
          button:hover {
            background-color: #C40000;
          }
        </style>
      </head>
      <body>
        <div>${mensagem}</div>
        <button onclick="window.close()">JOGAR NOVAMENTE</button>
      <script src="/assets/js/dfs-standard.js"></script>
</body>
      </html>
    `);
    novaAba.document.close();

    reiniciarJogo();
  }

  function handleCellClick(e) {
    const index = e.target.dataset.index;
    if (board[index] || !isGameActive) return;

    board[index] = currentPlayer;
    e.target.textContent = currentPlayer;
    checkWinner();

    if (isGameActive) {
      currentPlayer = 'O';
      setTimeout(machineMove, 300);
    }
  }

  function machineMove() {
    let move = findBestMove();
    board[move] = currentPlayer;
    cells[move].textContent = currentPlayer;
    checkWinner();
    currentPlayer = 'X';
  }

  function findBestMove() {
    for (let cond of winningConditions) {
      const [a,b,c] = cond;
      if (board[a] === board[b] && board[c] === '' && board[a] === 'O') return c;
      if (board[a] === board[c] && board[b] === '' && board[a] === 'O') return b;
      if (board[b] === board[c] && board[a] === '' && board[b] === 'O') return a;
    }
    for (let cond of winningConditions) {
      const [a,b,c] = cond;
      if (board[a] === board[b] && board[c] === '' && board[a] === 'X') return c;
      if (board[a] === board[c] && board[b] === '' && board[a] === 'X') return b;
      if (board[b] === board[c] && board[a] === '' && board[b] === 'X') return a;
    }
    if (board[4] === '') return 4;
    const corners = [0,2,6,8];
    for (let i of corners) if (board[i] === '') return i;
    const empty = board.map((v,i)=>v===''?i:null).filter(v=>v!==null);
    return empty[Math.floor(Math.random()*empty.length)];
  }

  function checkWinner() {
    for (let cond of winningConditions) {
      const [a,b,c] = cond;
      if (board[a] && board[a] === board[b] && board[b] === board[c]) {
        isGameActive = false;
        if (board[a] === 'X') {
          playerScore++;
          playerMoney += 50;
          updateScores();
          exibirResultado('üéâ VOC√ä VENCEU! +50 BLACKCOINS');
        } else {
          exibirResultado('üíÄ VOC√ä PERDEU! Mais sorte na pr√≥xima.');
        }
        return;
      }
    }
    if (!board.includes('')) {
      isGameActive = false;
      exibirResultado('‚öîÔ∏è EMPATE! Ningu√©m ganhou.');
    }
  }

  function updateScores() {
    document.getElementById('playerScore').textContent = playerScore;
    document.getElementById('playerMoney').textContent = playerMoney;
  }

  function reiniciarJogo() {
    board.fill('');
    isGameActive = true;
    currentPlayer = 'X';
    cells.forEach(cell => cell.textContent = '');
  }

  cells.forEach(cell => cell.addEventListener('click', handleCellClick));
</script>

</body>
</html>
